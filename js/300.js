"use strict";(self["webpackChunkdental_blade"]=self["webpackChunkdental_blade"]||[]).push([[300],{3300:function(e,l,a){a.r(l),a.d(l,{default:function(){return ee}});var t=a(641),o=a(953),u=a(33),n=a(3751),i=a(4335),s=a(4853),r=a(6583),d=a(9232),c=a(4176),p=a(7337);const v=e=>((0,t.Qi)("data-v-30103d75"),e=e(),(0,t.jt)(),e),k={class:"admin-promotions"},m={class:"admin-header"},b=v((()=>(0,t.Lk)("option",{value:""},"все страницы",-1))),_=["value"],f=v((()=>(0,t.Lk)("hr",null,null,-1))),L={class:"promotions__content"},g={key:0,class:"promotions__add-form"},h={class:"input-field"},y=v((()=>(0,t.Lk)("label",null,"Услуга:",-1))),w=["value"],C={class:"input-field"},R=v((()=>(0,t.Lk)("label",null,"Скидка:",-1))),P={class:"input-field"},F=v((()=>(0,t.Lk)("label",null,"Slug:",-1))),$={class:"input-field"},x=v((()=>(0,t.Lk)("label",null,"Старая цена:",-1))),E={class:"input-field"},N=v((()=>(0,t.Lk)("label",null,"Новая цена:",-1))),V={class:"form__buttons"},A={class:"promotions-list"},J={class:"item__content"},U={key:0},z={class:"item__buttons"},K=["onClick"],X=["onClick"],W={key:0,class:"promotions__edit-form"},I={class:"input-field"},D=v((()=>(0,t.Lk)("label",null,"Название:",-1))),B={class:"input-field"},Q=v((()=>(0,t.Lk)("label",null,"Скидка:",-1))),S={class:"input-field"},j=v((()=>(0,t.Lk)("label",null,"Slug:",-1))),M={class:"input-field"},q=v((()=>(0,t.Lk)("label",null,"Старая цена:",-1))),G={class:"input-field"},H=v((()=>(0,t.Lk)("label",null,"Новая цена:",-1))),O={class:"form__buttons"};var T=(0,t.pM)({__name:"index",setup(e){const l=(0,o.KR)([]),a=(0,o.KR)(null),v=(0,o.KR)(!1),T=(0,o.KR)(!1),Y=(0,o.KR)([]),Z=(0,o.KR)(""),ee=(0,t.EW)((()=>Z.value?l.value.filter((e=>e.slug===Z.value)):l.value)),le=(0,t.EW)((()=>{const e=p.J.find((e=>"/"===e.path)),l=p.J.find((e=>"/services"===e.path)),a=l?.children?.filter((e=>""!==e.path))||[];return[e&&{name:e.name,path:e.path},...a.map((e=>({name:e.name,path:`/services/${e.path}`})))].filter(Boolean)})),ae=(0,o.KR)({price_id:"",discount:0,slug:Z.value,oldPrice:0,newPrice:0}),te=()=>{const e=localStorage.getItem("token");return e||(console.error("Токен отсутствует"),null)},oe=async()=>{try{const e=await i.A.get("http://5.35.90.116:8000/promotions");l.value=e.data}catch(e){console.error("Ошибка при получении акций:",e)}},ue=async()=>{try{const e=await i.A.get("http://5.35.90.116:8000/prices");Y.value=e.data}catch(e){console.error("Ошибка при получении цен:",e)}},ne=e=>{v.value=!0,a.value={...e}},ie=()=>{v.value=!1,a.value=null},se=async()=>{const e=te();if(!e)return void console.error("Невозможно сохранить акцию, так как отсутствует токен.");const l={price_id:v.value?a.value.price_id:ae.value.price_id,discount:v.value?a.value.discount:ae.value.discount,slug:v.value?a.value.slug:Z.value,oldPrice:v.value?a.value.oldPrice:ae.value.oldPrice,newPrice:v.value?a.value.newPrice:ae.value.newPrice};console.log("Данные для сохранения:",l);try{v.value&&a.value.id?(await i.A.patch(`http://5.35.90.116:8000/promotions/${a.value.id}`,l,{headers:{Authorization:`Bearer ${e}`}}),console.log("Акция успешно обновлена")):(await i.A.post("http://5.35.90.116:8000/promotions",l,{headers:{Authorization:`Bearer ${e}`}}),console.log("Акция добавлена")),await oe(),ie(),de()}catch(t){i.A.isAxiosError(t)&&console.error("Ошибка при сохранении акции:",t.response?.data)}},re=async e=>{const l=te();if(!l)return;const a=window.confirm("Вы уверены, что хотите удалить этот результат?");if(a)try{await i.A.delete(`http://5.35.90.116:8000/promotions/${e}`,{headers:{Authorization:`Bearer ${l}`}}),console.log("Акция удалена"),oe()}catch(t){console.error("Ошибка при удалении акции:",t)}},de=()=>{T.value=!1},ce=()=>{ae.value.slug=Z.value,T.value=!0};return(0,t.sV)((()=>{oe(),ue()})),(e,l)=>((0,t.uX)(),(0,t.CE)("section",k,[(0,t.Lk)("div",m,[(0,t.bF)((0,o.R1)(s.D),{tagName:"h2",size:"xl"},{default:(0,t.k6)((()=>[(0,t.eW)("акции клиники")])),_:1}),(0,t.bo)((0,t.Lk)("select",{"onUpdate:modelValue":l[0]||(l[0]=e=>Z.value=e),class:"slug-select"},[b,((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(le.value,(e=>((0,t.uX)(),(0,t.CE)("option",{key:e?.path,value:e?.path},(0,u.v_)(e?.name),9,_)))),128))],512),[[n.u1,Z.value]])]),f,(0,t.Lk)("div",L,[(0,t.bF)((0,o.R1)(r.$),{class:"promotions__add-button",tagName:"button",size:"xs",color:"green",onClick:ce},{default:(0,t.k6)((()=>[(0,t.bF)((0,o.R1)(c.f),{tagName:"span",color:"dark"},{default:(0,t.k6)((()=>[(0,t.eW)(" добавить акцию ")])),_:1})])),_:1}),T.value?((0,t.uX)(),(0,t.CE)("form",g,[(0,t.Lk)("div",h,[y,(0,t.bo)((0,t.Lk)("select",{"onUpdate:modelValue":l[1]||(l[1]=e=>ae.value.price_id=e)},[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(Y.value,(e=>((0,t.uX)(),(0,t.CE)("option",{key:e.id,value:e.id},(0,u.v_)(e.name)+" - "+(0,u.v_)(e.price)+" Р ",9,w)))),128))],512),[[n.u1,ae.value.price_id]])]),(0,t.Lk)("div",C,[(0,t.bo)((0,t.Lk)("input",{type:"number","onUpdate:modelValue":l[2]||(l[2]=e=>ae.value.discount=e)},null,512),[[n.Jo,ae.value.discount]]),R]),(0,t.Lk)("div",P,[(0,t.bo)((0,t.Lk)("input",{type:"text","onUpdate:modelValue":l[3]||(l[3]=e=>ae.value.slug=e)},null,512),[[n.Jo,ae.value.slug]]),F]),(0,t.Lk)("div",$,[(0,t.bo)((0,t.Lk)("input",{type:"number","onUpdate:modelValue":l[4]||(l[4]=e=>ae.value.oldPrice=e)},null,512),[[n.Jo,ae.value.oldPrice]]),x]),(0,t.Lk)("div",E,[(0,t.bo)((0,t.Lk)("input",{type:"number","onUpdate:modelValue":l[5]||(l[5]=e=>ae.value.newPrice=e)},null,512),[[n.Jo,ae.value.newPrice]]),N]),(0,t.Lk)("div",V,[(0,t.bF)((0,o.R1)(r.$),{tagName:"button",size:"xs",color:"green",onClick:(0,n.D$)(se,["prevent"])},{default:(0,t.k6)((()=>[(0,t.bF)((0,o.R1)(c.f),{tagName:"span",color:"dark"},{default:(0,t.k6)((()=>[(0,t.eW)(" Сохранить ")])),_:1})])),_:1}),(0,t.bF)((0,o.R1)(r.$),{tagName:"button",size:"xs",color:"white",onClick:(0,n.D$)(de,["prevent"])},{default:(0,t.k6)((()=>[(0,t.bF)((0,o.R1)(c.f),{tagName:"span",color:"dark"},{default:(0,t.k6)((()=>[(0,t.eW)(" Отмена ")])),_:1})])),_:1})])])):(0,t.Q3)("",!0),(0,t.Lk)("ul",A,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(ee.value,(e=>((0,t.uX)(),(0,t.CE)("li",{key:e.id,class:"item"},[(0,t.Lk)("div",J,[(0,t.bF)((0,o.R1)(c.f),{tagName:"p",size:"xl",color:"dark",class:"item__text"},{default:(0,t.k6)((()=>[(0,t.eW)((0,u.v_)(e.price.name)+" ",1),e.discount?((0,t.uX)(),(0,t.CE)("span",U,"-"+(0,u.v_)(e.discount)+"%",1)):(0,t.Q3)("",!0),(0,t.Lk)("span",null,"Старая цена: "+(0,u.v_)(e.oldPrice)+" Р",1),(0,t.Lk)("span",null,"Новая цена: "+(0,u.v_)(e.newPrice)+" Р",1)])),_:2},1024),(0,t.Lk)("div",z,[(0,t.Lk)("span",{onClick:l=>ne(e)},[(0,t.bF)((0,o.R1)(d.I),{type:"edit",color:"dark"})],8,K),(0,t.Lk)("span",{onClick:l=>re(e.id)},[(0,t.bF)((0,o.R1)(d.I),{type:"delete",color:"red"})],8,X)])]),v.value&&a.value.id===e.id?((0,t.uX)(),(0,t.CE)("form",W,[(0,t.Lk)("div",I,[(0,t.bo)((0,t.Lk)("input",{type:"text","onUpdate:modelValue":l[6]||(l[6]=e=>a.value.price.name=e),disabled:""},null,512),[[n.Jo,a.value.price.name]]),D]),(0,t.Lk)("div",B,[(0,t.bo)((0,t.Lk)("input",{type:"number","onUpdate:modelValue":l[7]||(l[7]=e=>a.value.discount=e)},null,512),[[n.Jo,a.value.discount]]),Q]),(0,t.Lk)("div",S,[(0,t.bo)((0,t.Lk)("input",{type:"text","onUpdate:modelValue":l[8]||(l[8]=e=>a.value.slug=e)},null,512),[[n.Jo,a.value.slug]]),j]),(0,t.Lk)("div",M,[(0,t.bo)((0,t.Lk)("input",{type:"number","onUpdate:modelValue":l[9]||(l[9]=e=>a.value.oldPrice=e)},null,512),[[n.Jo,a.value.oldPrice]]),q]),(0,t.Lk)("div",G,[(0,t.bo)((0,t.Lk)("input",{type:"number","onUpdate:modelValue":l[10]||(l[10]=e=>a.value.newPrice=e)},null,512),[[n.Jo,a.value.newPrice]]),H]),(0,t.Lk)("div",O,[(0,t.bF)((0,o.R1)(r.$),{tagName:"button",size:"xs",color:"green",onClick:(0,n.D$)(se,["prevent"])},{default:(0,t.k6)((()=>[(0,t.bF)((0,o.R1)(c.f),{tagName:"span",color:"dark"},{default:(0,t.k6)((()=>[(0,t.eW)(" Сохранить ")])),_:1})])),_:1}),(0,t.bF)((0,o.R1)(r.$),{tagName:"button",size:"xs",color:"white",onClick:(0,n.D$)(ie,["prevent"])},{default:(0,t.k6)((()=>[(0,t.bF)((0,o.R1)(c.f),{tagName:"span",color:"dark"},{default:(0,t.k6)((()=>[(0,t.eW)(" Отмена ")])),_:1})])),_:1})])])):(0,t.Q3)("",!0)])))),128))])])]))}}),Y=a(6262);const Z=(0,Y.A)(T,[["__scopeId","data-v-30103d75"]]);var ee=Z}}]);
//# sourceMappingURL=300.js.map